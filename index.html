<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–∞–ª–µ–Ω–¥–∞—Ä—å-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üóìÔ∏è</text></svg>">
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <script type="importmap">
    {
      "imports": {
        "@google/genai": "https://esm.sh/@google/genai@^0.15.0",
        "marked": "https://esm.sh/marked@^15.0.8"
      }
    }
  </script>
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <div class="header-title">
        <span class="material-symbols-outlined header-logo">calendar_month</span>
        <h1>–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</h1>
      </div>
      <div class="header-actions">
        <div id="auth-status-container">
           <!-- Auth button / User avatar will be dynamically added here -->
        </div>
        <button id="settings-button" class="icon-button" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
          <span class="material-symbols-outlined">settings</span>
        </button>
      </div>
    </header>

    <main class="main-content">
      <div class="chat-panel view" id="chat-view" data-view="chat">
        <div id="message-list" role="log" aria-live="polite">
          <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
        </div>

        <div id="welcome-screen">
          <h2 id="welcome-greeting">–í–∞—à –ª–∏—á–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</h2>
          <p id="welcome-subheading" class="welcome-subheading">–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –≤–≤–µ–¥–∏—Ç–µ Gemini API Key –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.</p>
          <div id="suggestion-chips-container" style="display: none;">
            <button class="suggestion-chip">–°–æ–∑–¥–∞—Ç—å –≤—Å—Ç—Ä–µ—á—É –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 10 —É—Ç—Ä–∞ —Å –ò–≤–∞–Ω–æ–º –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞</button>
            <button class="suggestion-chip">–ö–∞–∫–∏–µ —É –º–µ–Ω—è –ø–ª–∞–Ω—ã –Ω–∞ —ç—Ç—É –ø—è—Ç–Ω–∏—Ü—É?</button>
            <button class="suggestion-chip">–ù–∞–ø–æ–º–Ω–∏ –º–Ω–µ –ø–æ–∑–≤–æ–Ω–∏—Ç—å –≤ —Å–µ—Ä–≤–∏—Å –≤ 15:00</button>
          </div>
        </div>

        <div id="loading-indicator" style="display: none;" aria-label="–ó–∞–≥—Ä—É–∑–∫–∞">
          <div class="spinner"></div>
          <span>–í—ã–ø–æ–ª–Ω—è—é...</span>
        </div>
        
        <div class="chat-input-container">
          <div id="chat-input-bar">
             <button id="camera-button-chat" class="icon-button" aria-label="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                <span class="material-symbols-outlined">add_photo_alternate</span>
              </button>
            <input type="file" id="image-upload-input-chat" accept="image/*" style="display: none;">
            <textarea id="chat-text-input" placeholder="–°–ø—Ä–æ—Å–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å..." aria-label="–¢–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥ –¥–ª—è —á–∞—Ç–∞" rows="1"></textarea>
            <div id="chat-input-actions">
                <button id="mic-button-chat" class="icon-button" aria-label="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥">
                  <span class="material-symbols-outlined">mic</span>
                </button>
                 <button id="send-button-chat" class="icon-button" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ" style="display: none;">
                    <span class="material-symbols-outlined">send</span>
                </button>
            </div>
          </div>
        </div>
      </div>

      <aside class="calendar-panel view" id="calendar-view" data-view="calendar">
          <div id="calendar-login-prompt" class="panel-placeholder">
            <span class="material-symbols-outlined">lock</span>
            <p>–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç Google, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤–∞—à –∫–∞–ª–µ–Ω–¥–∞—Ä—å.</p>
          </div>
          <div id="calendar-view-container" style="display: none;">
              <div id="calendar-container">
                  <div class="calendar-header">
                      <div class="month-navigation">
                          <h2 id="current-month-year"></h2>
                          <div class="calendar-controls">
                              <button id="prev-month-button" class="icon-button" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü">
                                  <span class="material-symbols-outlined">chevron_left</span>
                              </button>
                              <button id="today-button" class="action-button">–°–µ–≥–æ–¥–Ω—è</button>
                              <button id="next-month-button" class="icon-button" aria-label="–°–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü">
                                  <span class="material-symbols-outlined">chevron_right</span>
                              </button>
                          </div>
                      </div>
                  </div>
                  <div class="calendar-grid" id="calendar-grid-weekdays"></div>
                  <div class="calendar-grid" id="calendar-grid-days"></div>
              </div>
              <div id="daily-events-container">
                  <h3 id="daily-events-header"></h3>
                  <ul id="daily-events-list"></ul>
              </div>
          </div>
      </aside>
    </main>
    
    <nav class="mobile-tab-bar">
        <button class="tab-button active" data-view="chat">
            <span class="material-symbols-outlined">chat</span>
            <span>–ß–∞—Ç</span>
        </button>
        <button class="tab-button" data-view="calendar">
            <span class="material-symbols-outlined">calendar_month</span>
            <span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</span>
        </button>
    </nav>
  </div>

  <div id="settings-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="settings-title" style="display:none;">
      <div class="modal-content">
          <button id="close-settings-button" class="icon-button close-modal-button" aria-label="–ó–∞–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏">
              <span class="material-symbols-outlined">close</span>
          </button>
          <h2 id="settings-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
          
          <h4>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google</h4>
          <div id="auth-container-settings" class="settings-auth-status">
             <!-- Auth status and controls will be dynamically added here -->
          </div>
          
          <h4 style="margin-top: 24px;">–ö–ª—é—á API</h4>
          <div class="form-field">
            <label for="settings-gemini-api-key">Gemini API Key</label>
            <input type="password" id="settings-gemini-api-key" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à Gemini API Key">
            <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">–ü–æ–ª—É—á–∏—Ç—å API Key</a>
          </div>

          <div class="modal-actions">
            <button id="save-api-keys-button" class="action-button primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
          </div>
      </div>
  </div>

  <script>
    function onGapiLoad() { window.gapiLoadedCallback && window.gapiLoadedCallback(); }
    function onGisLoad() { window.gisInitalisedCallback && window.gisInitalisedCallback(); }
  </script>
  <script async defer src="https://apis.google.com/js/api.js" onload="onGapiLoad()"></script>
  <script async defer src="https://accounts.google.com/gsi/client" onload="onGisLoad()"></script>
  <script type="module" src="index.js"></script>
</body>
</html>