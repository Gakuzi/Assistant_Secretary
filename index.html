
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–∞–ª–µ–Ω–¥–∞—Ä—å-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üóìÔ∏è</text></svg>">
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <script type="importmap">
    {
      "imports": {
        "@google/genai": "https://esm.sh/@google/genai@^0.15.0",
        "marked": "https://esm.sh/marked@^15.0.8"
      }
    }
  </script>
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <div class="header-title">
        <span class="material-symbols-outlined header-logo">calendar_month</span>
        <h1>–ö–∞–ª–µ–Ω–¥–∞—Ä—å-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</h1>
      </div>
      <div class="header-actions">
        <div id="user-profile" style="display: none;">
          <img id="user-avatar" src="" alt="User Avatar">
          <span id="user-name"></span>
        </div>
        <button id="settings-button" class="icon-button" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
          <span class="material-symbols-outlined">settings</span>
        </button>
      </div>
    </header>

    <main class="main-content">
      <div class="chat-panel">
        <div id="message-list" role="log" aria-live="polite">
          <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
        </div>

        <div id="welcome-screen">
          <h2 id="welcome-greeting">–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!</h2>
          <p id="welcome-subheading" class="welcome-subheading">–ù–∞—á–Ω–∏—Ç–µ —Å –≤–≤–æ–¥–∞ –∫–ª—é—á–µ–π API –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.</p>
          <div id="suggestion-chips-container" style="display: none;">
            <button class="suggestion-chip">–°–æ–∑–¥–∞—Ç—å –≤—Å—Ç—Ä–µ—á—É –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 10 —É—Ç—Ä–∞ —Å –ò–≤–∞–Ω–æ–º –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞</button>
            <button class="suggestion-chip">–ö–∞–∫–∏–µ —É –º–µ–Ω—è –ø–ª–∞–Ω—ã –Ω–∞ —ç—Ç—É –ø—è—Ç–Ω–∏—Ü—É?</button>
            <button class="suggestion-chip">–ù–∞–ø–æ–º–Ω–∏ –º–Ω–µ –ø–æ–∑–≤–æ–Ω–∏—Ç—å –≤ —Å–µ—Ä–≤–∏—Å –≤ 15:00</button>
          </div>
        </div>

        <div id="loading-indicator" style="display: none;" aria-label="–ó–∞–≥—Ä—É–∑–∫–∞">
          <div class="spinner"></div>
          <span>–û–±—Ä–∞–±–æ—Ç–∫–∞...</span>
        </div>
        
        <div class="chat-input-container">
          <div id="chat-input-bar">
            <div class="camera-button-container">
              <button id="camera-button-chat" class="input-bar-button" aria-label="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                <span class="material-symbols-outlined">add_photo_alternate</span>
              </button>
            </div>
            <input type="file" id="image-upload-input-chat" accept="image/*" style="display: none;">
            <textarea id="chat-text-input" placeholder="–°–ø—Ä–æ—Å–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å..." aria-label="–¢–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥ –¥–ª—è —á–∞—Ç–∞" rows="1"></textarea>
            <button id="mic-button-chat" class="input-bar-button" aria-label="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥">
              <span class="material-symbols-outlined">mic</span>
            </button>
          </div>
        </div>
      </div>

      <aside class="calendar-panel">
          <div id="calendar-login-prompt">
            <p>–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤–∞—à –∫–∞–ª–µ–Ω–¥–∞—Ä—å.</p>
          </div>
          <div id="calendar-view-container" style="display: none;">
              <div id="calendar-container">
                  <div class="calendar-header">
                      <div class="month-navigation">
                          <h2 id="current-month-year"></h2>
                          <div class="calendar-controls">
                              <button id="prev-month-button" class="icon-button" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü">
                                  <span class="material-symbols-outlined">chevron_left</span>
                              </button>
                              <button id="today-button" class="action-button">–°–µ–≥–æ–¥–Ω—è</button>
                              <button id="next-month-button" class="icon-button" aria-label="–°–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü">
                                  <span class="material-symbols-outlined">chevron_right</span>
                              </button>
                          </div>
                      </div>
                  </div>
                  <div class="calendar-grid" id="calendar-grid-weekdays"></div>
                  <div class="calendar-grid" id="calendar-grid-days"></div>
              </div>
              <div id="daily-events-container">
                  <h3 id="daily-events-header"></h3>
                  <ul id="daily-events-list">
                      <!-- –°–æ–±—ã—Ç–∏—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–Ω—å -->
                  </ul>
              </div>
          </div>
      </aside>
    </main>
  </div>

  <div id="settings-modal" class="modal" style="display:none;" aria-hidden="true">
      <div class="modal-content settings-modal-content">
          <button id="close-settings-button" class="icon-button close-modal-button" aria-label="–ó–∞–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏">
              <span class="material-symbols-outlined">close</span>
          </button>
          <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
          
          <h4>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google</h4>
          <div id="auth-container-settings">
            <!-- Auth buttons will be dynamically added here for settings -->
          </div>
          
          <h4 style="margin-top: 24px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API-–∫–ª—é—á–∞–º–∏</h4>
          <div class="form-field">
            <label for="settings-gemini-api-key">Gemini API Key</label>
            <input type="password" id="settings-gemini-api-key" placeholder="–í–∞—à Gemini API Key">
            <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">–ü–æ–ª—É—á–∏—Ç—å API Key</a>
          </div>
          <div class="form-field">
            <label for="settings-google-client-id">Google Client ID</label>
            <input type="password" id="settings-google-client-id" placeholder="–í–∞—à Google Client ID">
             <a href="#" class="open-client-id-instructions">–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Client ID?</a>
          </div>
          <div class="modal-actions">
            <button id="save-api-keys-button" class="action-button primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á–∏</button>
          </div>
      </div>
  </div>
  
  <div id="google-client-id-instructions-modal" class="modal" style="display:none;" aria-hidden="true">
    <div class="modal-content instructions-modal-content">
      <button id="close-instructions-button" class="icon-button close-modal-button" aria-label="–ó–∞–∫—Ä—ã—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é">
        <span class="material-symbols-outlined">close</span>
      </button>
      <h2>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Google Client ID</h2>
      <div class="instructions-body">
        <ol>
          <li><strong>–û—Ç–∫—Ä–æ–π—Ç–µ Google Cloud Console.</strong>
            <a href="https://console.cloud.google.com/apis/credentials" target="_blank" rel="noopener noreferrer" class="action-button primary">–ü–µ—Ä–µ–π—Ç–∏ –≤ Google Cloud Console <span class="material-symbols-outlined">open_in_new</span></a>
          </li>
          <li><strong>–°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç.</strong></li>
          <li><strong>–í–∫–ª—é—á–∏—Ç–µ API.</strong> –í "–ë–∏–±–ª–∏–æ—Ç–µ–∫–µ API" –Ω–∞–π–¥–∏—Ç–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ <strong>Google Calendar API</strong>.</li>
          <li><strong>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —ç–∫—Ä–∞–Ω —Å–æ–≥–ª–∞—Å–∏—è OAuth.</strong> –í—ã–±–µ—Ä–∏—Ç–µ "External", –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, email, –∏ –Ω–∞–∂–º–∏—Ç–µ "Publish App".</li>
          <li><strong>–°–æ–∑–¥–∞–π—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.</strong> –ù–∞–∂–º–∏—Ç–µ "+ CREATE CREDENTIALS" –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "OAuth client ID".</li>
          <li><strong>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Client ID.</strong>
            <p>- –¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: <strong>"Web application"</strong>.
            <br>- –í "Authorized JavaScript origins", –Ω–∞–∂–º–∏—Ç–µ "+ ADD URI" –∏ –≤—Å—Ç–∞–≤—å—Ç–µ:
            <br><code>${window.location.origin}</code>
            <br>- –í "Authorized redirect URIs", –Ω–∞–∂–º–∏—Ç–µ "+ ADD URI" –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ:
            <br><code>${window.location.origin}</code>
            </p>
          </li>
           <li><strong>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à Client ID.</strong></li>
        </ol>
      </div>
    </div>
  </div>

  <script>
    function onGapiLoad() { window.gapiLoadedCallback && window.gapiLoadedCallback(); }
    function onGisLoad() { window.gisInitalisedCallback && window.gisInitalisedCallback(); }
  </script>
  
  <script async defer src="https://apis.google.com/js/api.js" onload="onGapiLoad()"></script>
  <script async defer src="https://accounts.google.com/gsi/client" onload="onGisLoad()"></script>
  
  <script type="module" src="index.js"></script>
</body>
</html>
